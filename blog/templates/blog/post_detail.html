{% extends "blog/base.html" %}

{% block content %}
<h1> Blog Home!! </h1>
<!-- so the class based views expect context variables to be named 'object'. Really 
reduces the amount of code needed to make a view-->
<article class="media content-section">
    <img class="rounded-circle article-img" src="{{object.author.profile.image.url}}">
    <div class="media-body">
        <div class="article-metadata">
            <a class="mr-2" href="{% url 'user-posts' object.author.username %}">{{ object.author }}</a>
            <small class="text-muted">{{ object.date_objected|date:"F d, Y" }}</small>
            {%if user.is_superuser %}
            <button><a class="btn btn-outline-secondary" href="{% url 'post-update' object.id %}"> Update
                </a></button>
            <button><a class="btn btn-danger" href="{% url 'post-delete' object.id %}"> Delete </a></button>
            {%endif%}
        </div>
        <h2 class="article-title"> {{ object.title|safe }}</h2>
        {%if post.header_image %}
            <img src="{{ object.header_image.url }}"> <br>
        {%endif%}
        <p class="article-content">{{ object.content|safe }}</p>
    </div>
</article>


<div class="comments-section">
    <h2> Comments </h2>
    {%if not post.comments.all %}
    {% if user.is_authenticated %}
    No comments yet... <a href="{% url 'add-comment' post.pk %}">Add a comment </a>
    {%else%}
    <a href = "{%url 'login' %}"> Log in </a> to post comments
    {%endif%}

    {%else%}
    <a href="{% url 'add-comment' post.pk %}">Add a comment </a>
    {%for comment in post.comments.all%}
    <hr>
    <strong>{{comment.name}} - {{comment.date_added }}</strong>
    {{ comment.body }}
    <hr>
    {%endfor%}
    {%endif%}
</div>

{% endblock content %}